---
title: "Final Project"
author: "Maureen Muthengi"
date: "2024-07-06"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

Instacart Market Basket Analysis

Which products will an Instacart consumer purchase again?

The Instacart Market Basket Analysis is a project that aims to predict which products a consumer is likely to purchase again during their next order. By analyzing historical purchase data from millions of orders, the goal is to uncover patterns and insights about consumer behavior. This analysis helps in understanding customer preferences, improving product recommendations, and optimizing inventory management. Key aspects include examining product reorder rates, identifying frequent product combinations, and leveraging machine learning models to make accurate predictions about future purchases.

For this analysis, I will use a logistic regression model to predict the likelihood of a product being reordered. Logistic regression is suitable for this task as it can handle binary outcomes (reordered or not reordered) and provides probabilities that help in making informed predictions. By predicting which products an Instacart consumer will purchase again, businesses can tailor marketing strategies, enhance customer satisfaction, and drive sales growth through personalized shopping experiences.

## Load the necessary Packages
```{r}

library(tidyverse)
library(caret)
library(ROCR)
```

## Load the Data

For this project we will Load the customer dataset and perform an initial exploration to understand its structure and contents. This step involves reading the CSV file and inspecting the first few rows to get a sense of the data.

```{r, echo=FALSE}
customer_data <- read.csv("~/Documents/Summer 2024/R_Activities_Summer 2024/Assignment/Website (Portfolio)/instacart-market-basket-analysis/order_products__prior.csv")
head(customer_data)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
glimpse(customer_data)
```


## Data Preprocessing
Clean the data by handling missing values and encoding categorical variables. In this case, we may not need extensive preprocessing since the dataset is already structured:

```{r}
# Check the structure of the data
str(customer_data)
```
Checking for missing values
```{r}
# Check for missing values
colSums(is.na(customer_data))
```

## Step-by-Step Logistic Regression:
1. Understanding Logistic Regression:
Logistic regression is used when the dependent variable (or outcome) is categorical. It predicts the probability of occurrence of an event by fitting data to a logistic curve.

2. Data Preparation:

Dependent Variable (Response): reordered (binary categorical: 0 or 1).
Independent Variables (Predictors): Typically numeric or categorical predictors like order_id, product_id, add_to_cart_order.

3. Data Exploration:
Explore your data to understand distributions, relationships, and any initial insights.

4. Model Building:
Formulate the Model: Specify the logistic regression model equation:

logit(𝑝) =𝛽0+𝛽1𝑥1+𝛽2𝑥2+⋯+𝛽𝑛𝑥𝑛
 
where 
𝑝p is the probability of the dependent variable, and 𝛽0,𝛽1,…,𝛽𝑛β 0 are coefficients.


## Computing Probabilities
Compute the probabilities of reordered being 1 using the logistic regression model. Here’s how you can do it:

```{r}
# Fit logistic regression model (assuming df is your preprocessed dataframe)
model <- glm(reordered ~ ., data = customer_data, family = "binomial")
```

```{r}

```

# Predict probabilities
probabilities <- predict(model, type = "response")

# Append probabilities to your dataframe for reference
df$predicted_probability <- probabilities

# View the probabilities
head(df[, c("reordered", "predicted_probability")])